<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-Content-Type-Options" content="nosniff">
  <meta http-equiv="X-Frame-Options" content="DENY">
  <meta name="referrer" content="strict-origin-when-cross-origin">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Quiz Attempts ‚Äî Wiser</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="../css/base.css">
  <link rel="stylesheet" href="../css/student.css">
  <link rel="icon" type="image/png" href="../assets/wiser-logo.png">
  <script>(function(){var t=localStorage.getItem('wiser_theme');if(t==='dark')document.documentElement.setAttribute('data-theme','dark')})()</script>
</head>
<body>

  <nav class="stu-navbar">
    <a href="../index.html" class="stu-navbar-logo"><img src="../assets/logo-Light-Theme.png" alt="Wiser" class="logo-light"><img src="../assets/Logo-Dark-Theme.png" alt="Wiser" class="logo-dark"></a>
    <div class="stu-navbar-center"><a href="../index.html">Home</a><a href="explore.html">Courses</a><a href="dashboard.html">Dashboard</a><a href="schools.html">Schools</a><a href="learning-hub.html">Learning Hub</a><a href="shop.html">Marketplace</a></div>
    <div class="stu-navbar-right">
      <button class="theme-toggle" onclick="ThemeManager.toggle()" aria-label="Toggle dark mode"><svg class="icon-moon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/></svg><svg class="icon-sun" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="display:none"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button>
      <button class="stu-search-btn"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg></button>
      <button class="stu-notif-btn" onclick="document.querySelector('.stu-notif-panel').classList.toggle('active');document.querySelector('.stu-notif-backdrop').classList.toggle('active')"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"/><path d="M13.73 21a2 2 0 0 1-3.46 0"/></svg><span class="stu-notif-badge">3</span></button>
      <button class="stu-cart-btn"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="9" cy="21" r="1"/><circle cx="20" cy="21" r="1"/><path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"/></svg><span class="stu-cart-badge">4</span></button>
      <a href="explore.html" class="stu-enroll-btn">Enroll Now</a>
      <button class="stu-mobile-toggle" onclick="document.querySelector('.stu-mobile-menu').classList.toggle('active');document.querySelector('.stu-mobile-overlay').classList.toggle('active')"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="18" x2="21" y2="18"/></svg></button>
    </div>
  </nav>

  <!-- Notification Panel -->
  <div class="stu-notif-backdrop" onclick="this.classList.remove('active');document.querySelector('.stu-notif-panel').classList.remove('active')"></div>
  <div class="stu-notif-panel">
    <div class="stu-notif-panel-header"><h3 style="font-size:16px;font-weight:700;">Notifications</h3><button class="stu-notif-mark-all" onclick="document.querySelectorAll('.stu-notif-item').forEach(i=>i.classList.remove('unread'));this.style.display='none';document.querySelector('.stu-notif-badge').style.display='none';">Mark all read</button></div>
    <div class="stu-notif-list" id="notifList"></div>
  </div>

  <!-- Mobile Menu -->
  <div class="stu-mobile-overlay" onclick="this.classList.remove('active');document.querySelector('.stu-mobile-menu').classList.remove('active')"></div>
  <div class="stu-mobile-menu" id="mobileMenu">
    <div class="stu-mobile-menu-links">
      <a href="dashboard.html">Dashboard</a>
      <a href="explore.html">Explore</a>
      <a href="enrolled-courses.html">My Courses</a>
      <a href="schools.html">Schools</a>
      <a href="learning-hub.html">Learning Hub</a>
      <a href="shop.html">Marketplace</a>
    </div>
  </div>

  <!-- Search Overlay -->
  <div class="stu-search-overlay" id="searchOverlay">
    <div class="stu-search-overlay-inner">
      <input type="text" placeholder="Search courses, topics, instructors..." autofocus>
      <button onclick="document.getElementById('searchOverlay').classList.remove('active')">‚úï</button>
    </div>
  </div>

  <div class="stu-banner">
    <img src="../assets/Cover-Photo/2.png" alt="" class="stu-banner-img">
    <div class="stu-banner-content">
      <div class="stu-banner-avatar" style="background: var(--gradient-primary)"><img src="../assets/Teacher-Student/3.png" alt="Jordan Rivera"></div>
      <div class="stu-banner-info"><h1 class="stu-banner-name">Jordan Rivera</h1><div class="stu-banner-meta"><span><span class="wi wi-book"></span> 5 Courses Enrolled</span><span><span class="wi wi-trophy"></span> 4 Certificates</span></div></div>
      <div class="stu-banner-actions"><a href="../auth/register.html?role=teacher" class="stu-become-instructor-btn">Become an Instructor ‚Üí</a></div>
    </div>
  </div>

  <div class="stu-body">
    <aside class="stu-sidebar">
      <div class="stu-sidebar-greeting">Welcome, Jordan Rivera</div>
      <ul class="stu-sidebar-nav">
        <li><a href="dashboard.html"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="7" height="7" rx="1"/><rect x="14" y="3" width="7" height="7" rx="1"/><rect x="3" y="14" width="7" height="7" rx="1"/><rect x="14" y="14" width="7" height="7" rx="1"/></svg> Dashboard</a></li>
        <li><a href="my-profile.html"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg> My Profile</a></li>
        <li><a href="enrolled-courses.html"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"/><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"/></svg> Enrolled Courses</a></li>
        <li><a href="shop.html"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M6 2L3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4z"/><line x1="3" y1="6" x2="21" y2="6"/><path d="M16 10a4 4 0 0 1-8 0"/></svg> Marketplace</a></li>
        <li><a href="wishlist.html"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z"/></svg> Wishlist</a></li>
        <li><a href="reviews.html"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg> Reviews</a></li>
        <li><a href="quiz-attempts.html" class="active"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/></svg> My Quiz Attempts</a></li>
        <li><a href="order-history.html"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="1" y="4" width="22" height="16" rx="2" ry="2"/><line x1="1" y1="10" x2="23" y2="10"/></svg> Order History</a></li>
      </ul>
      <div class="stu-sidebar-divider"></div>
      <div class="stu-sidebar-section-label">User</div>
      <ul class="stu-sidebar-nav">
        <li><a href="settings.html"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1-2.83 2.83l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-4 0v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83-2.83l.06-.06A1.65 1.65 0 0 0 4.68 15a1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1 0-4h.09"/></svg> Settings</a></li>
        <li><a href="../auth/login.html"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/><polyline points="16 17 21 12 16 7"/><line x1="21" y1="12" x2="9" y2="12"/></svg> Logout</a></li>
      </ul>
    </aside>

    <div class="stu-main">
      <h2 class="stu-main-title">My Quiz Attempts</h2>

      <div class="stu-table-wrapper">
        <table class="stu-table">
          <thead>
            <tr>
              <th>Date</th>
              <th>Quiz Title</th>
              <th>Questions</th>
              <th>Total Marks</th>
              <th>Correct Answers</th>
              <th>Result</th>
              <th></th>
            </tr>
          </thead>
          <tbody id="quizTableBody"></tbody>
        </table>
      </div>
    </div>
  </div>

  <footer class="stu-footer">
    <div class="stu-footer-content">
      <div class="stu-footer-brand"><img src="../assets/logo-Light-Theme.png" alt="Wiser" class="logo-light"><img src="../assets/Logo-Dark-Theme.png" alt="Wiser" class="logo-dark"><p>We're always in search for talented and motivated people. Don't be shy introduce yourself!</p><div class="stu-footer-socials"><a href="#">f</a><a href="#">ùïè</a><a href="#"><span class="wi wi-video"></span></a><a href="#">in</a></div><button class="stu-footer-contact-btn">Contact With Us ‚Üí</button></div>
      <div class="stu-footer-col"><h4>Useful Links</h4><ul><li><a href="explore.html">Marketplace</a></li><li><a href="#">Kindergarten</a></li><li><a href="#">University</a></li><li><a href="#">GYM Coaching</a></li><li><a href="#">FAQ</a></li><li><a href="#">About Us</a></li><li><a href="#">Privacy policy</a></li></ul></div>
      <div class="stu-footer-col"><h4>Our Company</h4><ul><li><a href="#">Contact Us</a></li><li><a href="../auth/register.html?role=teacher">Become Teacher</a></li><li><a href="#">Blog</a></li><li><a href="#">Instructor</a></li><li><a href="#">Events</a></li><li><a href="explore.html">Course</a></li><li><a href="#">Contact</a></li></ul></div>
      <div class="stu-footer-col"><h4>Get in Touch</h4><ul><li><a href="#">Phone: (406) 555-0120</a></li><li><a href="#">E-mail: admin@wiser.com</a></li></ul><h4 style="margin-top:16px;color:var(--primary-600);">Newsletter</h4><p style="font-size:12px;color:var(--gray-500);margin-bottom:8px;">2000+ Our students are subscribe Around the World.</p><div class="stu-footer-newsletter-form"><input type="email" placeholder="Enter Your Email Here"><button><span class="wi wi-mail"></span></button></div><button class="stu-footer-submit-btn">Submit Now</button></div>
    </div>
    <div class="stu-footer-bottom"><span>Copyright ¬© 2026 <span class="highlight">Wiser</span>. All Rights Reserved</span><div><a href="#">Terms of service</a><a href="#">Privacy policy</a><a href="#">Subscription</a><a href="../auth/login.html">Login & Register</a></div></div>
  </footer>

  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2.49.2/dist/umd/supabase.min.js" integrity="sha384-zhtfJ1S/qkpAToBl4XpbM2NH5uZgfUq2z4qo30Ed7TxgPxmkM+L1Gm94iyexzcJ6" crossorigin="anonymous"></script>
    <script src="../js/supabase-config.js"></script>
    <script src="../js/api.js"></script>
    <script src="../js/data.js"></script>
  <script src="../js/app.js"></script>
  <script>
    document.addEventListener('DOMContentLoaded', async () => {
      // Auth guard ‚Äî server-side role verification
      const __authProfile = await WiserAuth.requireAuth(['student', 'admin']);
      if (!__authProfile) return;

      const { user } = await StudentPage.init();
      if (!user) return;

      const quizzes = await WiserData.getQuizResults().catch(() => []);

      // Supplement with extra quiz data if needed
      const quizAttempts = [
        { date: 'March 10, 2025', title: 'JavaScript Basics Quiz', questions: 15, totalMarks: 30, correct: 13, result: 'Pass' },
        { date: 'March 8, 2025', title: 'React Fundamentals', questions: 20, totalMarks: 40, correct: 18, result: 'Pass' },
        { date: 'March 5, 2025', title: 'CSS Layout & Flexbox', questions: 10, totalMarks: 20, correct: 9, result: 'Pass' },
        { date: 'March 1, 2025', title: 'Python Data Structures', questions: 25, totalMarks: 50, correct: 15, result: 'Fail' },
        { date: 'Feb 25, 2025', title: 'Node.js & Express', questions: 12, totalMarks: 24, correct: 10, result: 'Pass' },
        { date: 'Feb 20, 2025', title: 'SQL Fundamentals', questions: 18, totalMarks: 36, correct: 12, result: 'Fail' },
        { date: 'Feb 15, 2025', title: 'Data Science Intro', questions: 10, totalMarks: 20, correct: 8, result: 'Pass' }
      ];

      document.getElementById('quizTableBody').innerHTML = quizAttempts.map(q => `
        <tr>
          <td style="white-space:nowrap; font-size: 13px; color: var(--gray-400);">${q.date}</td>
          <td><strong>${q.title}</strong></td>
          <td style="text-align:center;">${q.questions}</td>
          <td style="text-align:center;">${q.totalMarks}</td>
          <td style="text-align:center;">${q.correct}</td>
          <td><span class="stu-status ${q.result === 'Pass' ? 'stu-status-pass' : 'stu-status-fail'}">${q.result}</span></td>
          <td>
            <div class="stu-action-btns">
              <button class="stu-action-btn edit" onclick="viewQuizDetails(this)" title="View Details"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/><circle cx="12" cy="12" r="3"/></svg></button>
              <button class="stu-action-btn delete" onclick="this.closest('tr').remove(); Toast.show('Attempt removed', '', 'success')" title="Delete"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="3 6 5 6 21 6"/><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/></svg></button>
            </div>
          </td>
        </tr>
      `).join('');

      window.viewQuizDetails = function(btn) {
        const row = btn.closest('tr');
        const cells = row.querySelectorAll('td');
        const title = cells[1].textContent.trim();
        const date = cells[0].textContent.trim();
        const questions = cells[2].textContent.trim();
        const totalMarks = cells[3].textContent.trim();
        const correct = cells[4].textContent.trim();
        const result = cells[5].textContent.trim();
        const pct = Math.round((parseInt(correct) / parseInt(questions)) * 100);
        const wrong = parseInt(questions) - parseInt(correct);

        let overlay = document.getElementById('quizDetailOverlay');
        if (overlay) overlay.remove();
        overlay = document.createElement('div');
        overlay.id = 'quizDetailOverlay';
        overlay.style.cssText = 'position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.5);z-index:9999;display:flex;align-items:center;justify-content:center;';
        overlay.innerHTML = `
          <div style="background:var(--bg-primary, #fff);border-radius:16px;padding:32px;max-width:440px;width:90%;box-shadow:0 20px 60px rgba(0,0,0,0.2);">
            <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:20px;">
              <h3 style="margin:0;font-size:18px;">${title}</h3>
              <button onclick="document.getElementById('quizDetailOverlay').remove()" style="background:none;border:none;font-size:22px;cursor:pointer;color:var(--gray-400);">&times;</button>
            </div>
            <p style="font-size:13px;color:var(--gray-400);margin:0 0 16px;">Attempted on ${date}</p>
            <div style="display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-bottom:20px;">
              <div style="background:var(--gray-50);padding:12px;border-radius:10px;text-align:center;">
                <div style="font-size:24px;font-weight:700;color:#3d8b1c;">${pct}%</div>
                <div style="font-size:12px;color:var(--gray-400);">Score</div>
              </div>
              <div style="background:var(--gray-50);padding:12px;border-radius:10px;text-align:center;">
                <div style="font-size:24px;font-weight:700;color:${result==='Pass'?'#10B981':'#EF4444'};">${result}</div>
                <div style="font-size:12px;color:var(--gray-400);">Result</div>
              </div>
              <div style="background:var(--gray-50);padding:12px;border-radius:10px;text-align:center;">
                <div style="font-size:24px;font-weight:700;color:#10B981;">${correct}</div>
                <div style="font-size:12px;color:var(--gray-400);">Correct</div>
              </div>
              <div style="background:var(--gray-50);padding:12px;border-radius:10px;text-align:center;">
                <div style="font-size:24px;font-weight:700;color:#EF4444;">${wrong}</div>
                <div style="font-size:12px;color:var(--gray-400);">Wrong</div>
              </div>
            </div>
            <div style="background:var(--gray-50);padding:12px;border-radius:10px;margin-bottom:16px;">
              <div style="display:flex;justify-content:space-between;font-size:13px;margin-bottom:6px;">
                <span>Total Questions: ${questions}</span><span>Total Marks: ${totalMarks}</span>
              </div>
              <div style="background:var(--gray-200);border-radius:8px;height:8px;overflow:hidden;">
                <div style="width:${pct}%;height:100%;background:linear-gradient(90deg,#9fe870,#3d8b1c);border-radius:8px;"></div>
              </div>
            </div>
            <button onclick="document.getElementById('quizDetailOverlay').remove()" class="btn btn-primary" style="width:100%;">Close</button>
          </div>
        `;
        document.body.appendChild(overlay);
        overlay.addEventListener('click', e => { if (e.target === overlay) overlay.remove(); });
      };
    });
  </script>
</body>
</html>
