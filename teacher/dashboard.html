<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-Content-Type-Options" content="nosniff">
  <meta http-equiv="X-Frame-Options" content="DENY">
  <meta name="referrer" content="strict-origin-when-cross-origin">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Teacher Dashboard — Wiser</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="../css/base.css">
  <link rel="stylesheet" href="../css/app.css">
  <link rel="stylesheet" href="../css/teacher.css">
  <script>(function(){var t=localStorage.getItem('wiser_theme');if(t==='dark')document.documentElement.setAttribute('data-theme','dark')})()</script>
</head>
<body>
<div class="teacher-page">

  <!-- ========== TOP NAVBAR ========== -->
  <nav class="teacher-topbar">
    <div class="teacher-topbar-inner">
      <a href="../index.html" class="teacher-topbar-logo">
        <img src="../assets/logo-Light-Theme.png" alt="Wiser" class="logo-light"><img src="../assets/Logo-Dark-Theme.png" alt="Wiser" class="logo-dark">
      </a>
      <div class="teacher-topbar-nav">
        <a href="dashboard.html">Dashboard</a>
        <a href="schools.html">Schools</a>
        <a href="creator-hub.html">My Courses</a>
        <a href="analytics.html">Analytics</a>
        <a href="community.html">Community</a>
        <a href="payout.html">Payout</a>
      </div>
      <div class="teacher-topbar-actions">
        <button class="theme-toggle" onclick="ThemeManager.toggle()" aria-label="Toggle dark mode" ><svg class="icon-moon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/></svg><svg class="icon-sun" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="display:none"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button>
        <button class="stu-notif-btn" onclick="document.querySelector('.stu-notif-panel').classList.toggle('active');document.querySelector('.stu-notif-backdrop').classList.toggle('active')" ><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"/><path d="M13.73 21a2 2 0 0 1-3.46 0"/></svg><span class="stu-notif-badge">2</span></button>
        <a href="course-builder.html" class="btn btn-primary btn-sm">Create a New Course &rarr;</a>
        <button class="teacher-topbar-toggle" onclick="document.querySelector('.teacher-mobile-menu').classList.toggle('active');document.querySelector('.teacher-mobile-overlay').classList.toggle('active')" aria-label="Menu">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="18" x2="21" y2="18"/></svg>
        </button>
      </div>
    </div>
  </nav>

  <!-- Teacher Mobile Menu -->
  <div class="teacher-mobile-overlay" onclick="this.classList.remove('active');document.querySelector('.teacher-mobile-menu').classList.remove('active')"></div>
  <div class="teacher-mobile-menu">
    <a href="dashboard.html">Dashboard</a>
    <a href="schools.html">Schools</a>
    <a href="creator-hub.html">My Courses</a>
    <a href="analytics.html">Analytics</a>
    <a href="community.html">Community</a>
    <a href="payout.html">Payout</a>
    <a href="settings.html">Settings</a>
    <a href="course-builder.html">Create a New Course</a>
  </div>

  <!-- Notification Panel -->
  <div class="stu-notif-backdrop" onclick="this.classList.remove('active');document.querySelector('.stu-notif-panel').classList.remove('active')"></div>
  <div class="stu-notif-panel">
    <div class="stu-notif-panel-header"><h3 style="font-size:16px;font-weight:700;">Notifications</h3><button class="stu-notif-mark-all" onclick="document.querySelectorAll('.stu-notif-item').forEach(i=>i.classList.remove('unread'));this.style.display='none';document.querySelector('.stu-notif-badge').style.display='none';">Mark all read</button></div>
    <div class="stu-notif-list" id="notifList"></div>
  </div>

  <!-- ========== COVER BANNER ========== -->
  <div class="teacher-cover-banner">
    <div class="teacher-cover-content">
      <div class="teacher-cover-label">Bootcamp Instructor</div>
      <h1 class="teacher-cover-name">Learn With Sarah</h1>
    </div>
  </div>

  <!-- ========== PROFILE BAR ========== -->
  <div class="teacher-profile-bar">
    <div class="teacher-profile-avatar"><img src="../assets/Teacher-Student/1.png" alt="Sarah Chen"></div>
    <div class="teacher-profile-info">
      <div class="teacher-profile-info-name">Sarah Chen</div>
      <div class="teacher-profile-rating"><span class="wi wi-star"></span><span class="wi wi-star"></span><span class="wi wi-star"></span><span class="wi wi-star"></span><span class="wi wi-star"></span> <span style="color: rgba(255,255,255,0.7); margin-left: 4px;">(35 Reviews)</span></div>
    </div>
    <div class="teacher-profile-cta">
      <a href="course-builder.html" class="btn">Create a New Course &rarr;</a>
    </div>
  </div>

  <!-- ========== MAIN BODY ========== -->
  <div class="teacher-body">

    <!-- Left Sidebar Navigation -->
    <aside class="teacher-sidebar-card">
      <div class="teacher-sidebar-section">
        <div class="teacher-sidebar-label">Welcome, Sarah Chen</div>
        <a href="dashboard.html" class="teacher-nav-link active">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="7" height="7" rx="1"/><rect x="14" y="3" width="7" height="7" rx="1"/><rect x="3" y="14" width="7" height="7" rx="1"/><rect x="14" y="14" width="7" height="7" rx="1"/></svg>
          Dashboard
        </a>
        <a href="schools.html" class="teacher-nav-link">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/><polyline points="9 22 9 12 15 12 15 22"/></svg>
          Schools
        </a>
        <a href="analytics.html" class="teacher-nav-link">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="18" y1="20" x2="18" y2="10"/><line x1="12" y1="20" x2="12" y2="4"/><line x1="6" y1="20" x2="6" y2="14"/></svg>
          Analytics
        </a>
        <a href="payout.html" class="teacher-nav-link">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="12" y1="1" x2="12" y2="23"/><path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/></svg>
          Payout
        </a>
      </div>
      <div class="teacher-sidebar-divider"></div>
      <div class="teacher-sidebar-section">
        <div class="teacher-sidebar-label">Instructor</div>
        <a href="creator-hub.html" class="teacher-nav-link">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg>
          My Courses
        </a>
        <a href="course-builder.html" class="teacher-nav-link">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"/></svg>
          Course Builder
        </a>
        <a href="community.html" class="teacher-nav-link">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M23 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg>
          Community
        </a>
        <a href="store-manager.html" class="teacher-nav-link">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M6 2L3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4z"/><line x1="3" y1="6" x2="21" y2="6"/><path d="M16 10a4 4 0 0 1-8 0"/></svg>
          Store Manager
        </a>
      </div>
      <div class="teacher-sidebar-divider"></div>
      <div class="teacher-sidebar-section">
        <div class="teacher-sidebar-label">User</div>
        <a href="settings.html" class="teacher-nav-link">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06A1.65 1.65 0 0 0 4.68 15a1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06A1.65 1.65 0 0 0 9 4.68a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06A1.65 1.65 0 0 0 19.4 9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"/></svg>
          Settings
        </a>
        <a href="../auth/login.html" class="teacher-nav-link">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/><polyline points="16 17 21 12 16 7"/><line x1="21" y1="12" x2="9" y2="12"/></svg>
          Logout
        </a>
      </div>
    </aside>

    <!-- Right Content Area -->
    <div class="teacher-content">
      <h2 class="teacher-content-title">Dashboard</h2>

      <!-- Stat Cards -->
      <div class="teacher-stats-row">
        <div class="teacher-stat-card gradient-orange">
          <div class="teacher-stat-icon" style="background: #3d8b1c20; color: #3d8b1c">
            <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="12" y1="1" x2="12" y2="23"/><path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/></svg>
          </div>
          <span class="teacher-stat-value">$48,250</span>
          <span class="teacher-stat-label">Total Revenue</span>
        </div>
        <div class="teacher-stat-card gradient-amber">
          <div class="teacher-stat-icon" style="background: #5ab82e20; color: #5ab82e">
            <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M23 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg>
          </div>
          <span class="teacher-stat-value">18,420</span>
          <span class="teacher-stat-label">Total Students</span>
        </div>
        <div class="teacher-stat-card gradient-yellow">
          <div class="teacher-stat-icon" style="background: #2d691420; color: #2d6914">
            <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"/><path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"/></svg>
          </div>
          <span class="teacher-stat-value">6</span>
          <span class="teacher-stat-label">Active Courses</span>
        </div>
        <div class="teacher-stat-card gradient-red">
          <div class="teacher-stat-icon" style="background: #9fe87020; color: #9fe870">
            <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg>
          </div>
          <span class="teacher-stat-value">4.8</span>
          <span class="teacher-stat-label">Avg Rating</span>
        </div>
        <div class="teacher-stat-card gradient-orange">
          <div class="teacher-stat-icon" style="background: #6366F120; color: #6366F1">
            <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/></svg>
          </div>
          <span class="teacher-stat-value" id="unreadCount">2</span>
          <span class="teacher-stat-label">Unread Messages</span>
        </div>
      </div>

      <!-- My Courses Table -->
      <div class="teacher-card">
        <div class="teacher-card-header">
          <h3>My Courses</h3>
          <a href="creator-hub.html" class="btn btn-ghost btn-sm">Manage All</a>
        </div>
        <table class="teacher-table">
          <thead>
            <tr>
              <th>Course Name</th>
              <th>Enrolled</th>
              <th>Rating</th>
            </tr>
          </thead>
          <tbody id="teacherCoursesList"></tbody>
        </table>
        <a href="creator-hub.html" class="teacher-browse-link">Browse All Courses &rarr;</a>
      </div>

      <!-- Upcoming Classes -->
      <div class="teacher-card">
        <div class="teacher-card-header">
          <h3>Upcoming Classes</h3>
          <button class="btn btn-primary btn-sm" onclick="openScheduleModal()">+ Schedule Class</button>
        </div>
        <div id="upcomingClassesList" style="display:grid;gap:var(--space-4);"></div>
      </div>

      <!-- Revenue Chart + Recent Activity -->
      <div class="tg-2" style="gap: var(--space-6);">
        <div class="teacher-card">
          <div class="teacher-card-header">
            <h3>Revenue Overview</h3>
            <select class="form-select form-select-sm" style="width: auto; padding: 6px 10px; border: 1px solid var(--border-light); border-radius: var(--radius-md); font-size: var(--text-sm);">
              <option value="Last 7 days">Last 7 days</option>
              <option value="Last 30 days" selected>Last 30 days</option>
              <option value="Last 90 days">Last 90 days</option>
              <option value="This year">This year</option>
            </select>
          </div>
          <div class="chart-container" id="revenueChart"></div>
        </div>

        <div class="teacher-card">
          <div class="teacher-card-header">
            <h3>Recent Activity</h3>
          </div>
          <div class="teacher-activity-list">
            <div class="teacher-activity-item">
              <div class="teacher-activity-icon" style="background: #5ab82e20; color: #5ab82e">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="8.5" cy="7" r="4"/><line x1="20" y1="8" x2="20" y2="14"/><line x1="23" y1="11" x2="17" y2="11"/></svg>
              </div>
              <div class="teacher-activity-content">
                <p><strong>15 new enrollments</strong> in Data Science with Python</p>
                <span class="time">2 hours ago</span>
              </div>
            </div>
            <div class="teacher-activity-item">
              <div class="teacher-activity-icon" style="background: #9fe87020; color: #9fe870"><span class="wi wi-star"></span></div>
              <div class="teacher-activity-content">
                <p><strong>New review (5★)</strong> — "Best ML course!"</p>
                <span class="time">4 hours ago</span>
              </div>
            </div>
            <div class="teacher-activity-item">
              <div class="teacher-activity-icon" style="background: #3d8b1c20; color: #3d8b1c">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="12" y1="1" x2="12" y2="23"/><path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/></svg>
              </div>
              <div class="teacher-activity-content">
                <p><strong>$1,240 earned</strong> — Weekly payout</p>
                <span class="time">Yesterday</span>
              </div>
            </div>
            <div class="teacher-activity-item">
              <div class="teacher-activity-icon" style="background: #2d691420; color: #2d6914">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/></svg>
              </div>
              <div class="teacher-activity-content">
                <p><strong>3 new questions</strong> in Q&A</p>
                <span class="time">Yesterday</span>
              </div>
            </div>
            <div class="teacher-activity-item">
              <div class="teacher-activity-icon" style="background: #EF444420; color: #EF4444"><span class="wi wi-gift"></span></div>
              <div class="teacher-activity-content">
                <p><strong>Milestone!</strong> 5,000 students</p>
                <span class="time">2 days ago</span>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Messages / Inbox -->
      <div class="teacher-card">
        <div class="teacher-card-header">
          <h3>Messages</h3>
          <button class="btn btn-ghost btn-sm" onclick="Toast.show('Inbox','Opening full inbox...','info',1500)">View All</button>
        </div>
        <div id="teacherMessagesList" style="display:flex;flex-direction:column;gap:0;"></div>
      </div>

      <!-- Quick Actions -->
      <div class="teacher-card">
        <div class="teacher-card-header">
          <h3>Quick Actions</h3>
        </div>
        <div class="teacher-quick-actions">
          <a href="course-builder.html" class="teacher-quick-action">
            <div class="teacher-quick-action-icon" style="background: linear-gradient(135deg, #3d8b1c, #2d6914)">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>
            </div>
            <strong>Create Course</strong>
            <span class="text-xs text-secondary">Build from scratch</span>
          </a>
          <a href="analytics.html" class="teacher-quick-action">
            <div class="teacher-quick-action-icon" style="background: linear-gradient(135deg, #5ab82e, #3d8b1c)">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2"><line x1="18" y1="20" x2="18" y2="10"/><line x1="12" y1="20" x2="12" y2="4"/><line x1="6" y1="20" x2="6" y2="14"/></svg>
            </div>
            <strong>View Analytics</strong>
            <span class="text-xs text-secondary">Track metrics</span>
          </a>
          <a href="community.html" class="teacher-quick-action">
            <div class="teacher-quick-action-icon" style="background: linear-gradient(135deg, #9fe870, #2d6914)">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/></svg>
            </div>
            <strong>Community</strong>
            <span class="text-xs text-secondary">Engage students</span>
          </a>
          <a href="payout.html" class="teacher-quick-action">
            <div class="teacher-quick-action-icon" style="background: linear-gradient(135deg, #EF4444, #DC2626)">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2"><rect x="1" y="4" width="22" height="16" rx="2" ry="2"/><line x1="1" y1="10" x2="23" y2="10"/></svg>
            </div>
            <strong>Payout</strong>
            <span class="text-xs text-secondary">Manage payments</span>
          </a>
          <a href="#" class="teacher-quick-action" onclick="event.preventDefault();openScheduleModal()">
            <div class="teacher-quick-action-icon" style="background: linear-gradient(135deg, #8B5CF6, #6D28D9)">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/><line x1="10" y1="14" x2="14" y2="14"/><line x1="12" y1="12" x2="12" y2="16"/></svg>
            </div>
            <strong>Schedule Class</strong>
            <span class="text-xs text-secondary">Plan live session</span>
          </a>
        </div>
      </div>
    </div>
  </div>

  <!-- Schedule Live Class Modal -->
  <div id="scheduleModal" style="display:none;position:fixed;inset:0;z-index:9999;align-items:center;justify-content:center;background:rgba(0,0,0,0.5);">
    <div style="background:var(--bg-primary, #fff);border-radius:var(--radius-xl);padding:var(--space-8);width:100%;max-width:520px;margin:var(--space-4);box-shadow:var(--shadow-xl);position:relative;max-height:90vh;overflow-y:auto;">
      <button onclick="closeScheduleModal()" style="position:absolute;top:16px;right:16px;background:none;border:none;font-size:20px;cursor:pointer;color:var(--text-secondary);">&times;</button>
      <h3 style="font-size:var(--text-xl);font-weight:700;margin-bottom:var(--space-1);">Schedule Live Class</h3>
      <p style="color:var(--text-tertiary);font-size:var(--text-sm);margin-bottom:var(--space-6);">Set up a new live session for your students.</p>
      <form id="scheduleForm" onsubmit="submitScheduleForm(event)">
        <div style="margin-bottom:var(--space-4);">
          <label style="display:block;font-size:var(--text-sm);font-weight:600;margin-bottom:var(--space-1);">Class Title</label>
          <input type="text" id="schedTitle" required placeholder="e.g. Live Q&A: React Hooks" style="width:100%;padding:10px 14px;border:1px solid var(--border-light);border-radius:var(--radius-md);font-size:var(--text-sm);box-sizing:border-box;">
        </div>
        <div style="display:grid;grid-template-columns:1fr 1fr;gap:var(--space-4);margin-bottom:var(--space-4);">
          <div>
            <label style="display:block;font-size:var(--text-sm);font-weight:600;margin-bottom:var(--space-1);">Date</label>
            <input type="date" id="schedDate" required style="width:100%;padding:10px 14px;border:1px solid var(--border-light);border-radius:var(--radius-md);font-size:var(--text-sm);box-sizing:border-box;">
          </div>
          <div>
            <label style="display:block;font-size:var(--text-sm);font-weight:600;margin-bottom:var(--space-1);">Time</label>
            <input type="time" id="schedTime" required style="width:100%;padding:10px 14px;border:1px solid var(--border-light);border-radius:var(--radius-md);font-size:var(--text-sm);box-sizing:border-box;">
          </div>
        </div>
        <div style="display:grid;grid-template-columns:1fr 1fr;gap:var(--space-4);margin-bottom:var(--space-4);">
          <div>
            <label style="display:block;font-size:var(--text-sm);font-weight:600;margin-bottom:var(--space-1);">Duration (minutes)</label>
            <input type="number" id="schedDuration" required min="15" max="300" value="60" style="width:100%;padding:10px 14px;border:1px solid var(--border-light);border-radius:var(--radius-md);font-size:var(--text-sm);box-sizing:border-box;">
          </div>
          <div>
            <label style="display:block;font-size:var(--text-sm);font-weight:600;margin-bottom:var(--space-1);">Max Students</label>
            <input type="number" id="schedMaxStudents" required min="1" max="10000" value="200" style="width:100%;padding:10px 14px;border:1px solid var(--border-light);border-radius:var(--radius-md);font-size:var(--text-sm);box-sizing:border-box;">
          </div>
        </div>
        <div style="margin-bottom:var(--space-6);">
          <label style="display:block;font-size:var(--text-sm);font-weight:600;margin-bottom:var(--space-1);">Class Type</label>
          <select id="schedType" required style="width:100%;padding:10px 14px;border:1px solid var(--border-light);border-radius:var(--radius-md);font-size:var(--text-sm);box-sizing:border-box;background:var(--bg-primary, #fff);color:var(--text-primary);">
            <option value="live">Live Session</option>
            <option value="workshop">Workshop</option>
            <option value="office-hours">Office Hours</option>
            <option value="webinar">Webinar</option>
            <option value="masterclass">Masterclass</option>
          </select>
        </div>
        <div style="display:flex;gap:var(--space-3);justify-content:flex-end;">
          <button type="button" onclick="closeScheduleModal()" class="btn btn-ghost">Cancel</button>
          <button type="submit" class="btn btn-primary">Schedule Class</button>
        </div>
      </form>
    </div>
  </div>

  <!-- ========== FOOTER ========== -->
  <footer class="teacher-footer">
    <div class="teacher-footer-inner">
      <div class="teacher-footer-grid">
        <div>
          <div class="teacher-footer-brand"><img src="../assets/logo-Light-Theme.png" alt="Wiser" class="logo-light"><img src="../assets/Logo-Dark-Theme.png" alt="Wiser" class="logo-dark"><span>Wiser</span></div>
          <p class="teacher-footer-desc">We're always in search for talented and motivated people. Don't be shy, introduce yourself!</p>
          <div class="teacher-footer-socials">
            <a href="#" class="teacher-footer-social-icon">f</a>
            <a href="#" class="teacher-footer-social-icon">t</a>
            <a href="#" class="teacher-footer-social-icon">in</a>
            <a href="#" class="teacher-footer-social-icon">ig</a>
          </div>
        </div>
        <div>
          <h4>Useful Links</h4>
          <div class="teacher-footer-links"><a href="#">Marketplace</a><a href="#">Courses</a><a href="#">Community</a><a href="#">FAQ</a><a href="#">About Us</a><a href="#">Privacy Policy</a></div>
        </div>
        <div>
          <h4>Our Company</h4>
          <div class="teacher-footer-links"><a href="#">Contact Us</a><a href="schools.html">Invite Teachers</a><a href="#">Blog</a><a href="#">Events</a><a href="#">Careers</a></div>
        </div>
        <div>
          <h4>Get in Touch</h4>
          <p style="font-size:var(--text-sm);color:var(--text-tertiary);margin-bottom:var(--space-2)">Phone: (406) 555-0120<br>Email: admin@wiser.com</p>
          <p style="font-size:var(--text-sm);font-weight:600;margin-bottom:var(--space-2)">Newsletter</p>
          <p style="font-size:var(--text-xs);color:var(--text-tertiary);margin-bottom:var(--space-3)">2000+ students subscribe. Don't be shy!</p>
          <div class="teacher-footer-newsletter-form"><input type="email" placeholder="Enter Your Email Here"><button>Submit Now</button></div>
        </div>
      </div>
      <div class="teacher-footer-bottom">
        <span>Copyright &copy; 2026 <strong>Wiser</strong>. All Rights Reserved</span>
        <div class="teacher-footer-bottom-links"><a href="#">Terms of Service</a><a href="#">Privacy Policy</a><a href="../auth/login.html">Login &amp; Register</a></div>
      </div>
    </div>
  </footer>
</div>

<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2.49.2/dist/umd/supabase.min.js" integrity="sha384-zhtfJ1S/qkpAToBl4XpbM2NH5uZgfUq2z4qo30Ed7TxgPxmkM+L1Gm94iyexzcJ6" crossorigin="anonymous"></script>
    <script src="../js/supabase-config.js"></script>
    <script src="../js/api.js"></script>
    <script src="../js/data.js"></script>
<script src="../js/app.js"></script>
<script>
  document.addEventListener('DOMContentLoaded', async () => {
    // Auth guard — server-side role verification
    const __authProfile = await WiserAuth.requireAuth(['teacher', 'admin']);
    if (!__authProfile) return;

    // Load profile data dynamically
    try {
      const profile = await WiserAPI.profiles.getCurrent();
      if (profile) {
        const displayName = profile.display_name || ((profile.first_name || '') + ' ' + (profile.last_name || '')).trim() || 'Teacher';
        const firstName = profile.first_name || displayName.split(' ')[0] || 'Teacher';
        const coverNameEl = document.querySelector('.teacher-cover-name');
        const profileNameEl = document.querySelector('.teacher-profile-info-name');
        const sidebarLabel = document.querySelector('.teacher-sidebar-label');
        const profileAvatar = document.querySelector('.teacher-profile-avatar img');
        if (coverNameEl) coverNameEl.textContent = 'Learn With ' + firstName;
        if (profileNameEl) profileNameEl.textContent = displayName;
        if (sidebarLabel) sidebarLabel.textContent = 'Welcome, ' + displayName;
        if (profileAvatar) {
          if (profile.avatar_url) profileAvatar.src = profile.avatar_url;
          profileAvatar.alt = displayName;
        }
        const coverBanner = document.querySelector('.teacher-cover-banner');
        if (coverBanner && profile.cover_photo_url) coverBanner.style.backgroundImage = 'url(' + profile.cover_photo_url + ')';
        if (coverBanner && profile.cover_photo_url) coverBanner.style.backgroundSize = 'cover';
        const coverLabel = document.querySelector('.teacher-cover-label');
        if (coverLabel && profile.speciality) coverLabel.textContent = profile.speciality;
      }
    } catch (e) { console.warn('Profile load error:', e); }

    // Load all data asynchronously
    const [rawAnalytics, teacherCourses, teacherMessages, notifications, upcomingClasses, revenueChartData] = await Promise.all([
      WiserData.getTeacherAnalytics().catch(() => null),
      WiserData.getTeacherCourses().catch(() => []),
      WiserData.getTeacherMessages().catch(() => []),
      WiserData.getNotifications().catch(() => []),
      WiserData.getUpcomingClasses().catch(() => []),
      WiserAPI.teacherAnalytics.getRevenueChart(7).catch(() => [])
    ]);
    const a = rawAnalytics || { totalRevenue: 0, totalStudents: 0, avgRating: 0 };
    a.revenueByMonth = Array.isArray(revenueChartData) && revenueChartData.length > 0
      ? revenueChartData
      : [{ month: 'N/A', value: 0 }];

    // Populate stat cards
    const statCards = document.querySelectorAll('.teacher-stat-value');
    if (statCards[0]) statCards[0].textContent = '$' + Utils.formatNumber(a.totalRevenue || 0);
    if (statCards[1]) statCards[1].textContent = Utils.formatNumber(a.totalStudents || 0);
    if (statCards[2]) statCards[2].textContent = (teacherCourses || []).filter(c => c.status === 'published').length;
    if (statCards[3]) statCards[3].textContent = a.avgRating || 0;

    // Messages unread count
    const unreadCount = (teacherMessages || []).filter(m => m.unread).length;
    document.getElementById('unreadCount').textContent = unreadCount;

    // Update notification badge dynamically
    const teacherNotifs = Array.isArray(notifications) ? notifications : (notifications?.teacher || []);
    const teacherUnread = teacherNotifs.filter(n => n.unread || !n.read).length;
    const notifBadge = document.querySelector('.stu-notif-badge');
    if (notifBadge) notifBadge.textContent = teacherUnread;

    // Render Upcoming Classes
    const typeBadgeColors = { 'live': '#EF4444', 'workshop': '#8B5CF6', 'office-hours': '#0EA5E9', 'webinar': '#9fe870', 'masterclass': '#EC4899' };
    document.getElementById('upcomingClassesList').innerHTML = (upcomingClasses || []).map(cls => `
      <div style="display:flex;align-items:center;justify-content:space-between;padding:var(--space-4);border:1px solid var(--border-light);border-radius:var(--radius-lg);background:var(--bg-primary);flex-wrap:wrap;gap:var(--space-3);">
        <div style="display:flex;align-items:center;gap:var(--space-4);flex:1;min-width:200px;">
          <div style="width:48px;height:48px;border-radius:var(--radius-md);background:${typeBadgeColors[cls.type] || '#6366F1'}15;color:${typeBadgeColors[cls.type] || '#6366F1'};display:flex;align-items:center;justify-content:center;flex-shrink:0;">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>
          </div>
          <div>
            <strong style="font-size:var(--text-sm);display:block;margin-bottom:2px;">${cls.title}</strong>
            <span style="font-size:var(--text-xs);color:var(--text-tertiary);">${cls.date} &bull; ${cls.time} &bull; ${cls.duration}</span>
          </div>
        </div>
        <div style="display:flex;align-items:center;gap:var(--space-3);flex-wrap:wrap;">
          <span style="font-size:var(--text-xs);padding:3px 10px;border-radius:99px;background:${typeBadgeColors[cls.type] || '#6366F1'}15;color:${typeBadgeColors[cls.type] || '#6366F1'};font-weight:600;text-transform:capitalize;">${cls.type.replace('-',' ')}</span>
          <span style="font-size:var(--text-xs);color:var(--text-secondary);">${cls.enrolled}/${cls.maxStudents} enrolled</span>
          <button class="btn btn-primary btn-sm" onclick="Toast.show('Starting','Launching ${cls.title}...','success',1500)" style="font-size:var(--text-xs);padding:5px 14px;">Start</button>
          <button class="btn btn-ghost btn-sm" onclick="Toast.show('Edit','Opening editor...','info',1500)" style="font-size:var(--text-xs);padding:5px 14px;">Edit</button>
        </div>
      </div>
    `).join('');

    // Render Messages / Inbox
    document.getElementById('teacherMessagesList').innerHTML = (teacherMessages || []).map(msg => `
      <div style="display:flex;align-items:center;gap:var(--space-3);padding:var(--space-3) var(--space-4);border-bottom:1px solid var(--border-light);${msg.unread ? 'background:rgba(99,102,241,0.04);' : ''}">
        <div style="width:38px;height:38px;border-radius:50%;background:linear-gradient(135deg,#3d8b1c,#2d6914);color:#fff;display:flex;align-items:center;justify-content:center;font-size:var(--text-xs);font-weight:700;flex-shrink:0;">${msg.avatar}</div>
        <div style="flex:1;min-width:0;">
          <div style="display:flex;align-items:center;gap:var(--space-2);margin-bottom:2px;">
            <strong style="font-size:var(--text-sm);">${msg.from}</strong>
            ${msg.unread ? '<span style="width:8px;height:8px;border-radius:50%;background:#6366F1;display:inline-block;"></span>' : ''}
            <span style="font-size:var(--text-xs);color:var(--text-tertiary);margin-left:auto;white-space:nowrap;">${msg.time}</span>
          </div>
          <p style="font-size:var(--text-xs);color:var(--text-secondary);margin:0;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;">${msg.preview}</p>
        </div>
        <button class="btn btn-ghost btn-sm" style="font-size:var(--text-xs);padding:4px 10px;flex-shrink:0;" onclick="Toast.show('Reply','Opening reply to ${msg.from}...','info',1500)">Reply</button>
      </div>
    `).join('');

    // Revenue chart
    function renderRevenueChart(data) {
      if (!Array.isArray(data) || data.length === 0) data = [{ month: 'N/A', value: 0 }];
      const revenueValues = data.map(r => typeof r === 'object' ? r.value : r);
      const revenueLabels = data.map(r => typeof r === 'object' ? r.month : '');
      const maxR = Math.max(...revenueValues);
      document.getElementById('revenueChart').innerHTML = `
        <div class="bar-chart" style="height: 200px;">
          ${revenueValues.map((v, i) => `
            <div class="bar-group">
              <div class="bar-tooltip">$${Utils.formatNumber(v)}</div>
              <div class="bar" style="height: ${(v / maxR) * 100}%; background: ${i === revenueValues.length - 1 ? 'var(--gradient-primary)' : 'var(--primary-light)'}"></div>
              <span class="bar-label">${revenueLabels[i]}</span>
            </div>
          `).join('')}
        </div>
      `;
    }

    renderRevenueChart(a.revenueByMonth);

    // Revenue chart time range select
    document.querySelector('.teacher-card .form-select').addEventListener('change', function() {
      const range = this.value;
      let data = a.revenueByMonth;
      if (range === 'Last 7 days') data = data.slice(-2);
      else if (range === 'Last 90 days') data = data;
      else if (range === 'This year') data = data;
      renderRevenueChart(data);
      Toast.show('Chart updated', range, 'info', 1500);
    });

    // Teacher courses list with proper star ratings
    function renderStars(rating) {
      const full = Math.floor(rating);
      const half = rating % 1 >= 0.5 ? 1 : 0;
      return '<span class="wi wi-star"></span>'.repeat(full) + (half ? '<span class="wi wi-star"></span>' : '') + ` <span style="font-size:var(--text-xs);color:var(--text-tertiary)">(${rating})</span>`;
    }

    document.getElementById('teacherCoursesList').innerHTML = (teacherCourses || []).map(c => `
      <tr>
        <td style="display:flex;align-items:center;gap:10px"><img src="${c.thumbnail}" alt="${c.title}" style="width:40px;height:30px;border-radius:4px;object-fit:cover;max-width:none"><strong>${c.title}</strong></td>
        <td>${Utils.formatNumber(c.students)}</td>
        <td>${c.rating ? renderStars(c.rating) : '<span class="text-xs text-tertiary">No ratings</span>'}</td>
      </tr>
    `).join('');
  });

  // Schedule Modal functions
  function openScheduleModal() {
    const modal = document.getElementById('scheduleModal');
    modal.style.display = 'flex';
    document.getElementById('scheduleForm').reset();
  }

  function closeScheduleModal() {
    document.getElementById('scheduleModal').style.display = 'none';
  }

  function submitScheduleForm(e) {
    e.preventDefault();
    const title = document.getElementById('schedTitle').value;
    const date = document.getElementById('schedDate').value;
    const time = document.getElementById('schedTime').value;
    const duration = document.getElementById('schedDuration').value;
    const maxStudents = document.getElementById('schedMaxStudents').value;
    const type = document.getElementById('schedType').value;
    closeScheduleModal();
    Toast.show('Class Scheduled!', `"${title}" on ${date} at ${time} (${duration} min, ${type})`, 'success', 3000);
  }

  // Close modal on backdrop click
  document.getElementById('scheduleModal').addEventListener('click', function(e) {
    if (e.target === this) closeScheduleModal();
  });
</script>
</body>
</html>
